{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/canvas.coffee","src/event.coffee","src/id.coffee","src/layer.coffee","src/main.coffee","src/matrix.coffee","src/rect.coffee","src/stage.coffee","src/transform.coffee","src/util.coffee"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","Canvas","Event","EventProducer","Stage","Util","raw","this","$one","ctx","getContext","constructor","isHighDPI","enableHighDPI","eventProducer","currentStage","bindMouseEvent","devicePixelRatio","window","h","w","width","height","style","scale","addEventListener","_this","evt","x","data","offsetX","y","offsetY","fire","clear","clearRect","newStage","stage","on","event","listener","off","hasEvent","has","name","data1","context","listeners","indexOf","push","ref","aRemoveEqual","listenersOf","len","IDGenerator","seed","id","reset","Layer","Rect","positionX","positionY","frame","bounds","maskToBounds","rotate","borderWidth","borderColor","borderDirection","BORDER_DIRECTION","ALL","borderSemiMinorAxes","borderSemiMajorAxes","backgroundColor","parent","children","capturedTransform","TOP","RIGHT","BOTTOM","LEFT","_calculatePosition","origin","_applyRotate","tx","ty","size","translate","Math","PI","_drawPredefined","beginPath","getTransform","rect","fillStyle","fill","strokeStyle","stroke","closePath","_drawChildren","child","results","draw","drawing","idGenerator","save","restore","redraw","setRotate","degree","setBackgroundColor","color","setBorderWidth","addChild","addChildBefore","before","aInsertBefore","addChildAfter","after","aInsertAfter","removeChild","clearChildren","containPoint","ret","setTransform","b","c","d","isPointInPath","CanvasRenderingContext2D","brownie","Matrix","a1","b1","multiply","set","m","canvas","bindEvent","layers","addLayer","layer","addLayerBefore","addLayerAfter","removeLayer","clearLayers","broadcastMouseEvent","_walkLayers","cb","depth","walkLayers","fulfilled","sort","every","bubbling","forEach","_draw","_rotate","_scale","_setTransform","_transform","_translate","cos","hasCT","hasMozCT","proto","sin","prototype","currentTransform","mozCurrentTransform","transform","angle","type","obj","Object","toString","isString","isObject","toArray","Array","slice","selector","document","querySelector","$all","querySelectorAll","arr","eq","item","j","splice","stuff"],"mappings":"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","file":"brownie.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","Util = require('./util').Util\nStage = require('./stage').Stage\nEvent = require('./event').Event\nEventProducer = require('./event').EventProducer\n\nmodule.exports.Canvas = class Canvas\n  @devicePixelRatio: window.devicePixelRatio\n  @isHighDPI: @devicePixelRatio > 1\n\n  constructor: (@raw)->\n    if typeof @raw is 'string'\n      @raw = Util.$one @raw\n\n    if not @raw\n      throw new Error('deformed dom')\n\n    @ctx = @raw.getContext('2d');\n\n    if @constructor.isHighDPI\n      @enableHighDPI()\n\n    @eventProducer = new EventProducer(this)\n\n    @currentStage = null\n    @bindMouseEvent()\n\n  enableHighDPI: ->\n    w = @raw.width\n    h = @raw.height\n\n    @raw.width = w * @constructor.devicePixelRatio\n    @raw.height = h * @constructor.devicePixelRatio\n    @raw.style.width = w + 'px'\n    @raw.style.height = h + 'px'\n\n    @ctx.scale @constructor.devicePixelRatio, @constructor.devicePixelRatio\n\n  bindMouseEvent: ->\n    @raw.addEventListener 'click', (evt) =>\n      evt = new Event('click', evt)\n      evt.x = evt.data.offsetX * @constructor.devicePixelRatio\n      evt.y = evt.data.offsetY * @constructor.devicePixelRatio\n      if evt.x >= 0 and evt.y >= 0\n        @fire 'click', evt\n\n  clear: ->\n    @ctx.clearRect 0, 0, @raw.width, @raw.height\n    debugger;\n\n  newStage: ->\n    stage = new Stage(this)\n    return stage\n\n  on: (event, listener) ->\n    @eventProducer.on event, listener\n    return this\n\n  off: (event, listener) ->\n    @eventProducer.off event, listener\n    return this\n\n  fire: (event, data) ->\n    @eventProducer.fire event, data\n    return this\n\n  hasEvent: (event) ->\n    return @eventProducer.has event\n","Util = require('./util').Util\n\nmodule.exports.Event = class Event\n  constructor: (@name, @data) ->\n\nmodule.exports.EventProducer = class EventProducer\n  constructor: (context) ->\n    @context = context\n    @listeners = {}\n\n  on: (event, listener) ->\n    if typeof listener isnt 'function'\n      return this\n\n    listeners = @listeners[event]\n    if listeners is undefined\n      listeners = @listeners[event] = []\n\n    if listeners.indexOf(listener) is -1\n      listeners.push(listener)\n\n    return this\n\n  has: (event) ->\n    return @listeners[event]?.length > 0\n\n  off: (event, listener) ->\n    if listener is undefined\n      @listeners[event] = []\n    else\n      Util.aRemoveEqual(@listener[event], listener)\n\n    return this\n\n  listenersOf: (event) ->\n    listeners = @listeners[event]\n    return listeners ? []\n\n  fire: (event, data) ->\n    listeners = @listeners[event]\n    if listeners is undefined\n      return this\n\n    for listener in listeners\n      listener.call @context, data\n    return this\n","module.exports.IDGenerator = class IDGenerator\n  constructor: (@seed = 0) ->\n\n  id: ->\n    return @seed++\n\n  reset: (@seed = 0) ->\n","EventProducer = require('./event').EventProducer\nUtil = require('./util').Util\nRect = require('./rect').Rect\n\nmodule.exports.Layer = class Layer\n  @BORDER_DIRECTION:\n    TOP: (1 << 0)\n    RIGHT: 1 << 1\n    BOTTOM: 1 << 2\n    LEFT: 1 << 3\n    ALL: 0b1111\n\n  constructor: (x, y, width, height) ->\n    @id = -1\n\n    @positionX = 0\n    @positionY = 0\n\n    @frame = new Rect(x, y, width, height)\n    @bounds = new Rect(0, 0, width, height)\n\n    @maskToBounds = false\n\n    @rotate = 0\n\n    @borderWidth = 0\n    @borderColor = '#000'\n    @borderDirection = @constructor.BORDER_DIRECTION.ALL\n\n    @borderSemiMinorAxes = 0\n    @borderSemiMajorAxes = 0\n\n    @backgroundColor = null\n\n    @eventProducer = new EventProducer(this)\n\n    @parent = null;\n    @children = [];\n\n    @stage = null;\n    @ctx = null;\n\n    @capturedTransform = null;\n\n  _calculatePosition: ->\n    if @parent isnt null\n      @positionX = @parent.positionX + @parent.bounds.origin.x + @frame.origin.x\n      @positionY = @parent.positionY + @parent.bounds.origin.y + @frame.origin.y\n    else\n      @positionX = @frame.origin.x\n      @positionY = @frame.origin.y\n\n  _applyRotate: ->\n    if @rotate isnt 0\n      tx = @positionX + @frame.size.width / 2\n      ty = @positionY + @frame.size.height / 2\n\n      @ctx.translate tx, ty\n      @ctx.rotate @rotate * Math.PI / 180\n      @ctx.translate -tx, -ty\n\n  _drawPredefined: ->\n    @ctx.beginPath()\n\n    @_calculatePosition()\n    @_applyRotate()\n\n    @capturedTransform = @ctx.getTransform()\n\n    @ctx.beginPath()\n\n    @ctx.rect @positionX, @positionY, @frame.size.width, @frame.size.height\n\n    if @backgroundColor isnt null\n      @ctx.fillStyle = @backgroundColor\n      @ctx.fill()\n\n    if @borderWidth > 0\n      @ctx.strokeStyle = @borderColor\n      @ctx.stroke()\n\n    @ctx.closePath()\n\n  _drawChildren: ->\n    for child in @children\n      child.stage = @stage\n      child.ctx = @ctx\n      child.draw()\n\n  drawing: ->\n\n  draw: ->\n    if @ctx is null\n      return this\n\n    @id = @stage.idGenerator.id()\n\n    @ctx.save()\n\n    @_drawPredefined()\n    @drawing()\n\n    @_drawChildren()\n\n    @ctx.restore()\n    return this\n\n  redraw: ->\n    if @stage isnt null\n      @stage.redraw()\n\n  setRotate: (degree) ->\n    @rotate = degree\n    @redraw()\n\n  setBackgroundColor: (color) ->\n    @backgroundColor = color\n    @redraw()\n\n  setBorderWidth: (width) ->\n    @borderWidth = width\n    @redraw()\n\n  addChild: (child) ->\n    child.parent = this\n    @children.push child\n    @redraw()\n    return this\n\n  addChildBefore: (child, before) ->\n    child.parent = this\n    Util.aInsertBefore @children, child, before\n    @redraw()\n    return this\n\n  addChildAfter: (child, after) ->\n    child.parent = this\n    Util.aInsertAfter @children, child, after\n    @redraw()\n    return this\n\n  removeChild: (child) ->\n    Util.aRemoveEqual @children, child\n    @redraw()\n    return this\n\n  clearChildren: () ->\n    @children = []\n    @redraw()\n    return this\n\n  containPoint: (x, y) ->\n    if @ctx is null\n      return false\n\n    @ctx.save()\n    @ctx.setTransform @capturedTransform.a,\n      @capturedTransform.b,\n      @capturedTransform.c,\n      @capturedTransform.d\n      @capturedTransform.e,\n      @capturedTransform.f\n\n    @_calculatePosition()\n\n    @ctx.beginPath();\n\n    @ctx.rect @positionX, @positionY, @frame.size.width, @frame.size.height\n    ret = @ctx.isPointInPath x, y\n\n    @ctx.closePath()\n    @ctx.restore()\n    return ret\n\n  on: (event, listener) ->\n    @eventProducer.on event, listener\n    return this\n\n  off: (event, listener) ->\n    @eventProducer.off event, listener\n    return this\n\n  fire: (event, data) ->\n    @eventProducer.fire event, data\n    return this\n\n  hasEvent: (event) ->\n    return @eventProducer.has event\n\n  listenersOf: (event) ->\n    return @eventProducer.listenersOf event\n","if CanvasRenderingContext2D is undefined\n  throw new Error('browser does not support canvas')\n\nif window.brownie isnt undefined\n  throw new Error('namespace \\'brownie\\' has been used by other code')\n\nrequire './transform'\n\nwindow.brownie =\n  Util: require('./util').Util\n  Canvas: require('./canvas').Canvas\n  Rect: require('./rect').Rect\n  Layer: require('./layer').Layer\n","module.exports.Matrix = class Matrix\n  @multiply: (a, b) ->\n    return new Matrix(\n      a.a * b.a + a.c * b.b,\n      a.b * b.a + a.d * b.b,\n      a.a * b.c + a.c * b.b,\n      a.b * b.c + a.d * b.d,\n      a.a * b.e + a.c * b.f + a.e,\n      a.b * b.e + a.d * b.f + a.f\n    )\n\n  constructor: (@a = 1, @b = 0, @c = 0, @d = 1, @e = 0, @f = 0) ->\n\n  set: (@a = 1, @b = 0, @c = 0, @d = 1, @e = 0, @f = 0) ->\n\n  multiply: (m) ->\n    return @constructor.multiply(this, m)\n","module.exports.Rect = class Rect\n  constructor: (x = 0, y = 0, width = 0, height = 0) ->\n    @origin =\n      x: x\n      y: y\n    @size =\n      width: width\n      height: height","Util = require('./util').Util\nIDGenerator = require('./id').IDGenerator\n\nmodule.exports.Stage = class Stage\n  constructor: (@canvas) ->\n    if not @canvas?\n      throw new Error('must specify a canvas')\n\n    @bindEvent()\n\n    @layers = []\n\n    @idGenerator = new IDGenerator\n\n  addLayer: (layer) ->\n    @layers.push layer\n    @redraw()\n    return this\n\n  addLayerBefore: (layer, before) ->\n    Util.aInsertBefore @layers, layer, before\n    @redraw()\n    return this\n\n  addLayerAfter: (layer, after) ->\n    Util.aInsertAfter @layers, layer, after\n    @redraw()\n    return this\n\n  removeLayer: (layer) ->\n    Util.aRemoveEqual @layers, layer\n    @redraw()\n    return this\n\n  clearLayers: ->\n    @layers = []\n    @redraw()\n    return this\n\n  bindEvent: ->\n    @canvas.on 'click', (evt) =>\n      @broadcastMouseEvent evt\n\n  _walkLayers: (layers, cb, depth = 0) ->\n    if depth > 100\n      return\n\n    for layer in layers\n      cb layer, depth\n      if layer.children.length > 0\n        @_walkLayers layer.children, cb, depth++\n\n  walkLayers: (cb) ->\n    @_walkLayers @layers, cb\n\n  broadcastMouseEvent: (evt) ->\n    fulfilled = []\n    @walkLayers (layer) ->\n      if layer.containPoint evt.x, evt.y\n        fulfilled.push layer\n\n    fulfilled.sort (a, b) ->\n      return b.id - a.id\n\n    fulfilled.every (layer) ->\n      listeners = layer.listenersOf evt.name\n      bubbling = false\n      listeners.forEach (listener) ->\n        bubbling = (listener.call layer, evt.name, evt) ? false\n      return bubbling isnt false\n\n  _draw: ->\n    for layer in @layers\n      layer.stage = this\n      layer.ctx = @canvas.ctx\n      layer.draw()\n\n  redraw: ->\n    @canvas.clear()\n    @canvas.currentStage = this\n    @idGenerator.reset()\n    @_draw()\n    return this\n","Matrix = require('./matrix').Matrix\n\nsin = Math.sin\ncos = Math.cos\n\nproto = CanvasRenderingContext2D.prototype\n\nhasCT = 'currentTransform' of proto\nhasMozCT = 'mozCurrentTransform' of proto\n\nif hasCT or hasMozCT\n  proto.getTransform = do ->\n    if hasCT isnt undefined\n      return ->\n        return @currentTransform\n    else\n      return ->\n        return @mozCurrentTransform\n\nelse\n  _rotate = proto.rotate\n  _scale = proto.scale\n  _setTransform = proto.setTransform\n  _translate = proto.translate\n  _transform = proto.transform\n\n  proto.currentTransform = new Matrix\n\n  proto.setTransform = (a, b, c, d, e, f) ->\n    _setTransform.call this, a, b, c, d, e, f\n    @currentTransform.set a, b, c, d, e, f\n    return undefined\n\n  proto.rotate = (angle) ->\n    m = new Matrix(cos(angle), sin(angle), -sin(angle), cos(angle), 0, 0)\n    @currentTransform = @currentTransform.multiply m\n    _rotate.call this, angle\n    return undefined\n\n  proto.scale = (x, y) ->\n    m = new Matrix(x, 0, 0, y, 0, 0)\n    @currentTransform = @currentTransform.multiply m\n    _scale.call this, x, y\n    return undefined\n\n  proto.translate = (x, y) ->\n    m = new Matrix(0, 0, 0, 0, x, y)\n    @currentTransform = @currentTransform.multiply m\n    _translate.call this, x, y\n    return undefined\n\n  proto.transform = (a, b, c, d, e, f) ->\n    m = new Matrix(a, b, c, d, e, f)\n    @currentTransform = @currentTransform.multiply m\n    _transform.call this, a, b, c, d, e, f\n    return undefined\n\n  proto.getTransform = ->\n    return @currentTransform\n","module.exports.Util = class Util\n  @type: (obj) ->\n    return Object::toString.call obj\n\n  @isString: (obj) ->\n    return typeof obj is 'string'\n\n  @isObject: (obj) ->\n    return typeof obj is 'object' and obj isnt null\n\n  @toArray: (obj) ->\n    return  Array::slice.call obj\n\n  @$one: (selector) ->\n    return document.querySelector(selector)\n\n  @$all: (selector) ->\n    return @toArray document.querySelectorAll(selector)\n\n  @aRemoveEqual: (arr, eq) ->\n    for item, i in arr\n      if item is eq\n        arr.splice(i, 1)\n        return\n\n  @aInsertAfter: (arr, stuff, after) ->\n    for item, i in arr\n      if item is after\n        arr.splice i + 1, 0, stuff\n        return\n\n  @aInsertBefore: (arr, stuff, before) ->\n    for item, i in arr\n      if item is before\n        arr.splice i, 0, stuff\n        return\n"],"sourceRoot":"/source/"}